DATA CLEANING
CREATE OR REPLACE TABLE `rareair23.Cyclistic_Trip_Data.cleaned_24_25_Trip_Data_Combined` AS (
  SELECT
    ride_id,
    rideable_type,
    started_at,
    ended_at,
    TIMESTAMP_DIFF(ended_at, started_at, MINUTE) AS ride_length,
    FORMAT_DATETIME('%a', started_at) AS day_of_week,
    FORMAT_DATETIME('%b', started_at) AS month,
    start_station_name,
    end_station_name,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
    member_casual
  FROM
    `rareair23.Cyclistic_Trip_Data.24_25_Trip_Data_Combined`
  WHERE
    start_station_name IS NOT NULL
    AND end_station_name IS NOT NULL
    AND end_lat IS NOT NULL
    AND end_lng IS NOT NULL
    AND TIMESTAMP_DIFF(ended_at, started_at, MINUTE) > 1
    AND TIMESTAMP_DIFF(ended_at, started_at, MINUTE) < 1440
);

SELECT COUNT(ride_id) AS no_of_rows
FROM
  `rareair23.Cyclistic_Trip_Data.cleaned_24_25_Trip_Data_Combined`;
